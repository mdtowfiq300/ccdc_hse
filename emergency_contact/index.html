<!DOCTYPE html>
<html>
<head>
  <title>Haripur Job Location & Hospitals</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <!-- Leaflet Routing -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>

  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    #map { height: 100%; width: 100%; }
    .leaflet-popup-content { font-size: 15px; line-height: 1.4; }

    /* Floating emergency card */
    #emergencyCard {
      position: absolute;
      top: 120px;
      right: 10px;
      background: rgba(255, 255, 255, 0.95);
      padding: 12px 15px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.25);
      z-index: 1000;
      font-family: Arial, sans-serif;
      width: 220px;
    }
    #emergencyCard h3 {
      margin: 0 0 6px 0;
      font-size: 16px;
      color: #d63031;
    }
    #emergencyCard p {
      margin: 0;
      font-size: 14px;
      line-height: 1.5;
    }

    /* --- MOBILE ADJUSTMENTS --- */
    @media only screen and (max-width: 768px) {
      #emergencyCard {
        width: 220px;
        top: 60px;          /* appear from top */
        left: 50%;          /* center horizontally */
        transform: translateX(-50%);
        padding: 12px;
        font-size: 13px;
        max-height: 50vh;
        overflow-y: auto;
        display: none;      /* hidden initially */
      }

      #emergencyCard h3 {
        font-size: 14px;
      }

      #emergencyCard p {
        font-size: 12px;
        line-height: 1.3;
      }

      /* Toggle button */
      #emergencyToggleBtn {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 1100;
        background: #d63031;
        color: white;
        padding: 8px 12px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        cursor: pointer;
      }
    }
  </style>
</head>
<body>
<div id="map"></div>

<!-- Toggle button for mobile emergency card -->
<button id="emergencyToggleBtn">ğŸš¨ Emergency Contact </button>

<!-- Floating emergency contact card -->
<div id="emergencyCard">
  <h3>ğŸš¨ Emergency Contact</h3>
  <p><b>Haripur Fire Service</b><br>ğŸ“ 01304824900</p>
  <p><b>Jaintapur Model Police Station</b><br>Deputy Manager (Security)<br>ğŸ“ 01901023289</p>
  <p><b>Jaintapur Model Police Station</b><br>Beat Officer<br>ğŸ“ 01320-118059</p>
  <p><b>Jaintapur Model Police Station</b><br>Duty Officer<br>ğŸ“ 01320-118052</p>
  <p><b>RAB 9</b><br>ğŸ“ 01754-887196</p>
  <p><b>Emergency Services</b><br>ğŸ“ 999</p>
  <p><b>Fire Service Hotline</b><br>ğŸ“ 102</p>
</div>

<script>
  // Job location
  const jobLocation = [25.023511878654777, 92.06247645240666];

  // Hospitals with info
  const hospitals = [
    { name: "Sylhet MAG Osmani Medical College Hospital", coords: [24.90054308726357, 91.85232103706016], phone: "02996631213", address: "Medical College Rd, Sylhet", website: "https://www.somch.gov.bd/" },
    { name: "Mount Adora Hospital, Akhaliya, Sylhet", coords: [24.909751108585954, 91.84403409288302], phone: "09610848484", address: "Akhalia, Sylhet", website: "https://mountadora.com/" },
    { name: "Ibn Sina Hospital", coords: [24.891829828379016, 91.87750588123724], phone: "09610009640", address: "Subid Bazar, Sylhet", website: "http://www.ibnsinahospitalsylhet.com.bd/" },
    { name: "Al Haramain Hospital", coords: [24.889241245147087, 91.87972365237621], phone: "0821729981", address: "Subhani Ghat, Sylhet", website:"https://www.haramainhospital.com/" },
    { name: "Jalalabad Ragib-Rabeya Medical College and Hospital", coords: [24.913582887161652, 91.85243328123806], phone: "01779900016", address: "Pathantula, Sylhet", website: "http://jrrmc.edu.bd/" }
  ];

  // --- NEW LOCATIONS ---
  const otherLocations = [
    { 
      name: "Sylhet Gas Fields Limited", 
      coords: [24.967879747730475, 92.02573555742168], 
      phone: "0821760205", 
      address: "Tamabil Road", 
      website: "http://www.sgfl.org.bd/", 
      type: "gas" 
    },
    { 
      name: "Haripur Fire Service & Civil Defence", 
      coords: [24.93180590522598, 91.9737291936247], 
      phone: "01304824900", 
      address: "Tamabil Road", 
      website: "http://www.fireservice.gov.bd/", 
      type: "fire" 
    },

       { 
      name: "Fire Service & Civil Defence", 
      coords: [24.891414613092188, 91.86440884875667], 
      phone: "01730336644", 
      address: "Taltola , sylhet", 
      website: "http://www.fireservice.gov.bd/", 
      type: "fire" 
    },

        { 
      name: "Sylhet Metropolitan Police Office", 
      coords: [24.903328187676497, 91.87860164281719], 
      phone: "0821716968", 
      address: "Kumar para Road, sylhet", 
      website: "",
      type: "police" 
    },

         { 
      name: "Sylhet Highway Police Circle", 
      coords: [24.912003486720014, 91.94871670002118], 
      phone: "01320184634", 
      address: "Tamabil Road", 
      website: "",
      type: "police" 
    },
  ];

  // Include all points in bounds
  const allPoints = [jobLocation, ...hospitals.map(h => h.coords), ...otherLocations.map(l => l.coords)];
  const bounds = L.latLngBounds(allPoints);

  // Initialize map
  const map = L.map('map', { zoomControl: true });

  // English tile layer
  L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
  }).addTo(map);

  map.fitBounds(bounds);

  // Disable dragging/zooming only on PC
  if (window.innerWidth > 768) {
    map.dragging.disable();
    map.scrollWheelZoom.disable();
    map.doubleClickZoom.disable();
    map.boxZoom.disable();
    map.touchZoom.disable();
    map.keyboard.disable();
  }

  // Define custom icons
  const jobIcon = L.icon({
    iconUrl: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSIjiUI9ahF2z4JjlfZxNxktojfSrj6satVmQ&s',
    iconSize: [40, 40],
    iconAnchor: [20, 40],
    popupAnchor: [0, -30]
  });

  const hospitalIcon = L.icon({
    iconUrl: 'https://cdn-icons-png.flaticon.com/512/574/574692.png',
    iconSize: [32, 32],
    iconAnchor: [16, 32],
    popupAnchor: [0, -28]
  });

  const gasIcon = L.icon({
    iconUrl: 'https://upload.wikimedia.org/wikipedia/en/b/bc/Sylhet_Gas_Fields_Limited_logo.png',  // gas field icon
    iconSize: [36, 36],
    iconAnchor: [18, 36],
    popupAnchor: [0, -28]
  });

  const fireIcon = L.icon({
    iconUrl: 'images/fire truck.png',  // fire service icon
    iconSize: [36, 36],
    iconAnchor: [18, 36],
    popupAnchor: [0, -28]
  });

   const policeIcon = L.icon({
    iconUrl: 'https://cdn-icons-png.freepik.com/512/10275/10275817.png',  // fire service icon
    iconSize: [25, 25],
    iconAnchor: [18, 36],
    popupAnchor: [0, -28]
  });

  // Job marker
  const jobMarker = L.marker(jobLocation, { icon: jobIcon })
    .addTo(map)
    .bindPopup("â›ï¸ CCDC 10x ")
    .openPopup();

  let activeHospital = null;

  // Hospital markers
  hospitals.forEach(hospital => {
    const marker = L.marker(hospital.coords, { icon: hospitalIcon })
      .addTo(map)
      .bindPopup(hospital.name);

    marker.on('click', function() {
      if (activeHospital === hospital.name) {
        if (window.routeControl) {
          map.removeControl(window.routeControl);
          window.routeControl = null;
        }
        activeHospital = null;
        marker.closePopup();
        jobMarker.openPopup();
        return;
      }

      if (window.routeControl) map.removeControl(window.routeControl);

      window.routeControl = L.Routing.control({
        waypoints: [
          L.latLng(jobLocation[0], jobLocation[1]),
          L.latLng(hospital.coords[0], hospital.coords[1])
        ],
        lineOptions: { styles: [{ color: 'blue', weight: 6, opacity: 0.7 }] },
        createMarker: () => null,
        routeWhileDragging: false,
        show: false
      }).addTo(map);

      marker.bindPopup(
        `<b>${hospital.name}</b><br>
         ğŸ“ ${hospital.address}<br>
         ğŸš— Distance: calculating...<br>
         â˜ï¸ ${hospital.phone}<br>
         ${hospital.website}`
      ).openPopup();

      activeHospital = hospital.name;

      window.routeControl.on('routesfound', function(e) {
        const route = e.routes[0];
        const distanceKm = (route.summary.totalDistance / 1000).toFixed(1);
        const durationMin = Math.round(route.summary.totalTime / 60);

        marker.setPopupContent(
          `<b>${hospital.name}</b><br>
           ğŸ“ ${hospital.address}<br>
           ğŸš— ${distanceKm} km, ${durationMin} min<br>
           â˜ï¸ ${hospital.phone} <br>
           ${hospital.website}`
        ).openPopup();
      });
    });
  });

  // --- NEW MARKERS ---
  otherLocations.forEach(loc => {
    const icon = loc.type === "gas" ? gasIcon 
            : loc.type === "fire" ? fireIcon 
            : loc.type === "police" ? policeIcon 
            : hospitalIcon;   // fallback just in case

    const marker = L.marker(loc.coords, { icon })
      .addTo(map)
      .bindPopup(loc.name);

    marker.on('click', function() {
      if (activeHospital === loc.name) {
        if (window.routeControl) {
          map.removeControl(window.routeControl);
          window.routeControl = null;
        }
        activeHospital = null;
        marker.closePopup();
        jobMarker.openPopup();
        return;
      }

      if (window.routeControl) map.removeControl(window.routeControl);

      window.routeControl = L.Routing.control({
        waypoints: [
          L.latLng(jobLocation[0], jobLocation[1]),
          L.latLng(loc.coords[0], loc.coords[1])
        ],
        lineOptions: { styles: [{ color: 'blue', weight: 6, opacity: 0.7 }] },
        createMarker: () => null,
        routeWhileDragging: false,
        show: false
      }).addTo(map);

      marker.bindPopup(
        `<b>${loc.name}</b><br>
         ğŸ“ ${loc.address}<br>
         ğŸš— Distance: calculating...<br>
         â˜ï¸ ${loc.phone}<br>
         ${loc.website}`
      ).openPopup();

      activeHospital = loc.name;

      window.routeControl.on('routesfound', function(e) {
        const route = e.routes[0];
        const distanceKm = (route.summary.totalDistance / 1000).toFixed(1);
        const durationMin = Math.round(route.summary.totalTime / 60);

        marker.setPopupContent(
          `<b>${loc.name}</b><br>
           ğŸ“ ${loc.address}<br>
           ğŸš— ${distanceKm} km, ${durationMin} min<br>
           â˜ï¸ ${loc.phone} <br>
           ${loc.website}`
        ).openPopup();
      });
    });
  });

  // Toggle emergency card on mobile
  const toggleBtn = document.getElementById('emergencyToggleBtn');
  const emergencyCard = document.getElementById('emergencyCard');

  toggleBtn.addEventListener('click', function() {
    if (emergencyCard.style.display === 'none' || emergencyCard.style.display === '') {
      emergencyCard.style.display = 'block';
    } else {
      emergencyCard.style.display = 'none';
    }
  });
</script>

</body>
</html>




