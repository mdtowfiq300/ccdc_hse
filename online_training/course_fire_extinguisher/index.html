<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fire Extinguisher: Types, Uses & Safety</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <!-- We are loading the PDF.js library from a CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
  <style>
    /* General Body Styles */
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f9f9f6;
      margin: 0;
      padding: 0;
      color: #2c3e50;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Header Styles */
    header {
      text-align: center;
      padding: .5rem 1rem;
      background-color: #ffffff;
      border-bottom: 1px solid #e0e0e0;
      width: 100%;
    }

    header h1 {
      margin: 0;
      font-size: 2.5rem;
    }

    .tagline {
      margin-top: 0.5rem;
      color: #888;
    }

    /* Main Content Area */
    .course-content {
      padding: 2rem 1rem;
      max-width: 900px;
      width: 100%;
      box-sizing: border-box;
      text-align: center;
    }

    /* PDF Viewer Styles */
    #pdf-viewer-container {
      margin-bottom: 1.5rem;
    }
    
    #loading-indicator {
        font-size: 1.2rem;
        color: #555;
        padding: 4rem 0;
    }

    #pdf-canvas {
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      max-width: 100%;
      height: auto; /* Maintain aspect ratio */
    }

    #pdf-nav {
      margin-top: 1rem;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      /* Initially hidden until PDF loads */
      visibility: hidden; 
    }

    .nav-btn {
      padding: 0.6rem 1.2rem;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
      font-family: 'Poppins', sans-serif;
      font-size: 1rem;
    }

    .nav-btn:hover:not(:disabled) {
      background-color: #0056b3;
      transform: translateY(-2px);
    }
    
    .nav-btn:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    #page-num-display {
      font-size: 1.1rem;
      font-weight: 600;
      min-width: 100px; /* Prevents layout shift */
    }
    
    /* Course Description & Quiz Button */
    .course-description {
      font-size: 1rem;
      color: #444;
    }

    .btn {
      display: inline-block;
      margin-top: 1rem;
      padding: 0.8rem 1.5rem;
      background-color: #f57c00;
      color: white;
      border: none;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      transition: background 0.3s, transform 0.2s;
    }

    .btn:hover {
      background-color: #ef6c00;
      transform: translateY(-2px);
    }
  </style>
</head>
<body>
  <header>
    <h1>ðŸ”¥ Fire Extinguisher: Types, Uses & Safety</h1>
    <p class="tagline">An in-depth guide to fire extinguisher types and their proper use.</p>
  </header>

  <main class="course-content">
    <!-- PDF Viewer Section -->
    <div id="pdf-viewer-container">
        <div id="loading-indicator">Loading Document...</div>
        <canvas id="pdf-canvas"></canvas>
        <div id="pdf-nav">
            <button id="prev-page" class="nav-btn">Previous</button>
            <span id="page-num-display"></span>
            <button id="next-page" class="nav-btn">Next</button>
        </div>
    </div>

    <div class="course-description">
      <p>Use the "Next" and "Previous" buttons to navigate through the training material. When you are finished, you can test your knowledge.</p>
      <a href="quiz/fire_extinguisher_quiz.html" class="btn">ðŸ“„ Take a Quiz</a>
    </div>
  </main>

  <script>
    // =========================================================================
    // IMPORTANT: Change this URL to the location of your PDF file.
    // To avoid cross-origin (CORS) issues, the PDF should be on the same
    // domain as your website, or the server hosting it must allow requests.
    // =========================================================================
    const url = 'Fire Extinguisher Bangla.pdf';

    // Set worker location for PDF.js
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.worker.min.js';

    // State variables
    let pdfDoc = null;
    let pageNum = 1;
    let pageRendering = false;
    let pageNumPending = null;
    const scale = 1.5;

    // Get elements from the DOM
    const canvas = document.getElementById('pdf-canvas');
    const ctx = canvas.getContext('2d');
    const prevButton = document.getElementById('prev-page');
    const nextButton = document.getElementById('next-page');
    const pageNumDisplay = document.getElementById('page-num-display');
    const loadingIndicator = document.getElementById('loading-indicator');
    const navControls = document.getElementById('pdf-nav');

    /**
     * Renders a specific page of the PDF onto the canvas.
     * @param {number} num The page number to render.
     */
    const renderPage = num => {
      pageRendering = true;
      // Get the page from the loaded PDF document
      pdfDoc.getPage(num).then(page => {
        const viewport = page.getViewport({ scale: scale });
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        // Render PDF page into canvas context
        const renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        const renderTask = page.render(renderContext);

        // Wait for rendering to finish
        renderTask.promise.then(() => {
          pageRendering = false;
          if (pageNumPending !== null) {
            // New page was waiting for the current one to finish
            renderPage(pageNumPending);
            pageNumPending = null;
          }
          // Update UI
          updateNavButtons();
        });
      });

      // Update page counter
      pageNumDisplay.textContent = `Page ${num} of ${pdfDoc.numPages}`;
    };

    /**
     * If another page is rendering, wait for it to finish. Otherwise, render the new page.
     */
    const queueRenderPage = num => {
      if (pageRendering) {
        pageNumPending = num;
      } else {
        renderPage(num);
      }
    };

    /**
     * Disables or enables the Previous/Next buttons based on the current page.
     */
    const updateNavButtons = () => {
        prevButton.disabled = (pageNum <= 1);
        nextButton.disabled = (pageNum >= pdfDoc.numPages);
    }

    /**
     * Displays the previous page.
     */
    const onPrevPage = () => {
      if (pageNum <= 1) {
        return;
      }
      pageNum--;
      queueRenderPage(pageNum);
    };

    /**
     * Displays the next page.
     */
    const onNextPage = () => {
      if (pageNum >= pdfDoc.numPages) {
        return;
      }
      pageNum++;
      queueRenderPage(pageNum);
    };

    // Add event listeners to the buttons
    prevButton.addEventListener('click', onPrevPage);
    nextButton.addEventListener('click', onNextPage);

    /**
     * Asynchronously downloads and loads the PDF.
     */
    pdfjsLib.getDocument(url).promise.then(pdfDoc_ => {
      pdfDoc = pdfDoc_;
      // Hide loading indicator and show controls
      loadingIndicator.style.display = 'none';
      navControls.style.visibility = 'visible';
      // Render the first page
      renderPage(pageNum);
    }).catch(err => {
        // Handle errors, e.g., PDF not found or CORS issue
        loadingIndicator.textContent = 'Error: Could not load the PDF document. Please check the file path and CORS settings.';
        console.error('Error loading PDF:', err);
    });
  </script>
</body>
</html>

